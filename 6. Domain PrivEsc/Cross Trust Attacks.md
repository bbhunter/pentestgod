# Cross Trust Attacks

> Used to escalate privileges across domains and across forests. From DA of the current domain to EA/DA of the forest root.

There are two types of trusts:

1. Across domains: Implicit two way trust relationship.
2. Across forests: Trust relationship needs to be established manually.

_____

### Across Domains

> From a child domain we will escalate our privileges to forest root.

Domains in same forest have an implicit two-way trust with other domains. The trust is automatically generated but there is a trust key between the parent and child domains.

There are two ways of escalating privileges between two domains of the same forest:

1. Trust tickets
2. Krbtgt hash

_____

### Trust tickets

When accessing resources in other domains. Steps made in the Kerberos auth:

1. We request a TGT from the KDC (current domain).
2. We receive a TGT from the KDC (current domain).
3. We request a TGS from the KDC (current domain).
4. KDC checks that the service is in a parent domain. KDC returns a inter-realm TGT.
5. We request a TGS for the service from the KDC (of the parent domain).
6. We receive a TGS for the service from the KDC (of the parent domain).
7. We present that TGS to the service in the parent domain.

**Note:** The abusable step is the 5th one. The only check is made is that the parent domain KDC can decrypt the ticket, which is encrypted with the trust key.

If we have access to the trust key, we can forge an inter realm TGT and the parent domain will assume it to be valid.
